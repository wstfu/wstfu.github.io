<!DOCTYPE html>
<html>

<head>
    <title>匯率轉換計算機</title>
    <link rel="stylesheet" type="text/css" href="mystyle.css">
</head>

<body>
    <h1>匯率轉換計算機</h1>

    <div>
        <label for="amount">請輸入台幣金額：</label>
        <input type="text" id="amount" placeholder="輸入金額">
        <button type = "button" onclick = "loadDoc()">執行計算</button>
        <button type = "button" onclick = "reset()">重新開始</button>
    </div>

    <table id="output"></table>

    <script>
        function loadDoc() {
            const xhttp = new XMLHttpRequest();

            xhttp.onload = function () {
                calculate(this);
            }

            xhttp.open("GET", "./rate.xml", true);
            xhttp.send();
        }

        function calculate(xml) {
            const xmlDoc = xml.responseXML;
            const x = xmlDoc.getElementsByTagName("RATE");
            //檢查輸入是否為數字
            if(!amount || isNaN(amount)){
                alert("請輸入數字");
                reset();
                return;
            }

            let table = "<tr><th>幣別</th><th>匯率</th><th>結果</th></tr>";

            for (let i = 0; i < x.length; i++) {
                table += "<tr><td>" + x[i].getElementsByTagName("currency")[0].childNodes[0].nodeValue + "</td><td>" +
                    x[i].getElementsByTagName("value")[0].childNodes[0].nodeValue + "</td><td>" +
                    x[i].getElementsByTagName("value")[0].childNodes[0].nodeValue * document.getElementById("amount").value + "</td></tr>";
            }

            document.getElementById("output").innerHTML = table;
        }

        //reset
        //清除表格
        function reset() {
            document.getElementById("amount").value = "";
            document.getElementById("output").innerHTML = "";

        }
    </script>
</body>

</html>
